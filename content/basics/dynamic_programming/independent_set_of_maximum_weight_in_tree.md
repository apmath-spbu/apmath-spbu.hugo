---
linkTitle: "üå≥üèÜ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ –¥–µ—Ä–µ–≤–µ"
title: "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ –¥–µ—Ä–µ–≤–µ"
date: 2025-04-24T17:19:09+03:00
draft: false
weight: 70
---

–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≤ –≥—Ä–∞—Ñ–µ _–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ_ (_independent_), –µ—Å–ª–∏ –Ω–∏–∫–∞–∫–∞—è –ø–∞—Ä–∞ –≤–µ—Ä—à–∏–Ω –≤ –Ω—ë–º –Ω–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∞ —Ä–µ–±—Ä–æ–º.

–î–∞–Ω–æ –¥–µ—Ä–µ–≤–æ, –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ $v$ –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–º–µ–µ—Ç –≤–µ—Å $w_{v}$. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –≤–µ—Å–∞.

‚úçÔ∏è –ù–µ–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ (–≤—Å–µ –≤–µ—Å–∞ —Ä–∞–≤–Ω—ã –µ–¥–∏–Ω–∏—Ü–µ) —Ä–µ—à–∞–µ—Ç—Å—è –∂–∞–¥–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º.

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º

–í—ã–±–µ—Ä–µ–º –ª—é–±—É—é –≤–µ—Ä—à–∏–Ω—É $r$ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞. –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ –¥–µ—Ä–µ–≤–∞ $v$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–∑–∞–¥–∞—á–∞ –ø–æ–∏—Å–∫–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ —ç—Ç–æ–π –≤–µ—Ä—à–∏–Ω—ã; –æ–±–æ–∑–Ω–∞—á–∏–º –∏—Å–∫–æ–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞ $I_{v}$. –ö–∞–∫ –≤—ã—Ä–∞–∑–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –¥–ª—è –≤–µ—Ä—à–∏–Ω—ã $v$ —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ–ø—Ä–æ—â–µ? –ï—Å–ª–∏ —Å–∞–º–∞ –≤–µ—Ä—à–∏–Ω–∞ $v$ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ $I_{v}$, —Ç–æ $I_{v}$ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ $I_{u}$ –ø–æ –≤—Å–µ–º $u$ - –¥–µ—Ç—è–º $v$. –ï—Å–ª–∏ –∂–µ $v$ –≤—Ö–æ–¥–∏—Ç –≤ $I_{v}$, —Ç–æ –Ω–∏–∫—Ç–æ –∏–∑ –¥–µ—Ç–µ–π $v$ –≤ $I_{v}$ –≤—Ö–æ–¥–∏—Ç—å –Ω–µ –º–æ–∂–µ—Ç. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ $I_{v}$ - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ $I_{u}$ –ø–æ –≤—Å–µ–º $u$ - "–≤–Ω—É–∫–∞–º" $v$ - –¥–µ—Ç—è–º –¥–µ—Ç–µ–π $v$.

–ü—É—Å—Ç—å

$$
I[v]=\sum_{u \in I_{v}} w_{u}
$$

–£–¥–æ–±–Ω–æ —Ç–∞–∫–∂–µ –≤–≤–µ—Å—Ç–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É

$$
J[v]=\sum_{u-\text { —Ä–µ–±—ë–Ω–æ–∫ } v} I[u] .
$$

–ò–∑ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π –≤—ã—à–µ –ø–æ–ª—É—á–∞–µ–º

$$
I[v]=\max \left(J[v], w_{v}+\sum_{u-\text { —Ä–µ–±—ë–Ω–æ–∫ } v} J[u]\right) .
$$

–¢–µ–ø–µ—Ä—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è $I$, $J$ –ª–µ–≥–∫–æ –≤—ã—á–∏—Å–ª–∏—Ç—å, –∑–∞–ø—É—Å—Ç–∏–≤ –ø–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É –∏–∑ $r$. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(V+E)$.
```py
dfs(v, parent):
    I[v] = w[v], J[v] = 0
    for u in to[v]:
        if u == parent:
            continue
        dfs(u, v)
        I[v] += J[u], J[v] += I[u]
    I[v] = max(I[v], J[v])
dfs(0, -1) # r = 0
```

–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
```py
# skip = True, –µ—Å–ª–∏ –≤–µ—Ä—à–∏–Ω–∞ v —Ç–æ—á–Ω–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç
restoreSet(v, parent, skip):
    childSkip = False
    if (not skip) and I[v] > J[v]: # v –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç
        res.push_back(v)
        childSkip = True # –¥–µ—Ç–∏ v –≤ –æ—Ç–≤–µ—Ç –Ω–µ –≤—Ö–æ–¥—è—Ç
    for u in to[v]:
        if u == parent:
            continue
        restoreSet(u, v, childSkip)
restoreSet(0, -1, False)
```