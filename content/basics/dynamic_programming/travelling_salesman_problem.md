---
linkTitle: "üöóüåç –ó–∞–¥–∞—á–∞ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞"
title: "–ó–∞–¥–∞—á–∞ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞"
date: 2025-04-24T17:19:09+03:00
draft: false
weight: 80
---

–ö–æ–º–º–∏–≤–æ—è–∂—ë—Ä (travelling salesman) —Ö–æ—á–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π –∏–∑ $n$ –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É —Ä–∞–∑—É –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Å–≤–æ–π —Ä–æ–¥–Ω–æ–π –≥–æ—Ä–æ–¥. –û–Ω –∑–Ω–∞–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ –≥–æ—Ä–æ–¥–æ–≤. –ö–∞–∫–æ–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ—Å–µ—â–µ–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∞–ª–µ–Ω?

–ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ: –¥–∞–Ω –ø–æ–ª–Ω—ã–π (–µ—Å—Ç—å —Ä–µ–±—Ä–æ –º–µ–∂–¥—É –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π –≤–µ—Ä—à–∏–Ω) –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ –Ω–∞ $n$ –≤–µ—Ä—à–∏–Ω–∞—Ö; –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª (—Ü–∏–∫–ª, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π –ø–æ –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω–µ —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑), –∏–º–µ—é—â–∏–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—É—é –¥–ª–∏–Ω—É. –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∞–º–∏ $u$ –∏ $v$ –±—É–¥–µ–º –æ–±–æ–∑–Ω–∞—á–∞—Ç—å –∫–∞–∫ $d_{u, v}$.

–í—Å–µ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ $(n-1)$ !, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–±–æ—Ä –∏—Ö –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–µ–Ω –ª–∏—à—å –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–∏—Ö $n$. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º —ç—Ç—É –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –∑–∞ $O\left(2^{n} \cdot n^{2}\right)$, —á—Ç–æ —É–∂–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ (—Ö–æ—Ç—è –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—Å—ë –µ—â—ë —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞).

–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - –∑–∞–¥–∞—á–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è "–ø—Ä–µ—Ñ–∏–∫—Å–∞" –º–∞—Ä—à—Ä—É—Ç–∞ (–ø–µ—Ä–≤—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä—ë–±–µ—Ä –º–∞—Ä—à—Ä—É—Ç–∞, –Ω–∞—á–∏–Ω–∞—è –∏–∑ —Ä–æ–¥–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞; –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –≥–æ—Ä–æ–¥ –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä 0). –ö–∞–∫ –º–æ–∂–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—á–∞–ª–æ –º–∞—Ä—à—Ä—É—Ç–∞? –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–µ—Ñ–∏–∫—Å –º–∞—Ä—à—Ä—É—Ç–∞ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–æ–¥–ª–∏—Ç—å (–∏–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–±—Ä–∞), –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ –≤–µ—Ä—à–∏–Ω—ã –≤—Ö–æ–¥—è—Ç –≤ –ø—Ä–µ—Ñ–∏–∫—Å, –∞ —Ç–∞–∫–∂–µ –∫–∞–∫–∞—è –∏–∑ –Ω–∏—Ö —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ—Ç—Å—è –ø–∞—Ä–æ–π $(A, v)$, –≥–¥–µ $A$ - –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –≤–µ—Ä—à–∏–Ω—É 0 , $v \in A$ - –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—à–∏–Ω—ã –≤ –ø—Ä–µ—Ñ–∏–∫—Å–µ –º–∞—Ä—à—Ä—É—Ç–∞.

–ù–∞—á–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è: $l[\{0\}, 0]=0 ; l[A, 0]=\infty$ –ø—Ä–∏ $|A|>1$. –î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Ä–µ–±—Ä–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –º–∞—Ä—à—Ä—É—Ç–∞: –ø—É—Å—Ç—å $v \neq 0, v \in A$, —Ç–æ–≥–¥–∞

$$
l[A, v]=\min _{\substack{u \in A, u \neq v}}\left(l[A \backslash\{v\}, u]+d_{u, v}\right)
$$

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–¥–∞—á—É –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—à–∏–Ω—É –º–∞—Ä—à—Ä—É—Ç–∞: –æ—Ç–≤–µ—Ç —Ä–∞–≤–µ–Ω

$$
\min _{v>0}\left(l[A, v]+d_{v, 0}\right) .
$$

–ü—Ä–µ–∂–¥–µ, —á–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –º–∞—Å—Å–∏–≤–∞, –∞ —Ç–∞–∫–∂–µ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –Ω–∞–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞).

### –†–∞–±–æ—Ç–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏

–ü—Ä–æ–Ω—É–º–µ—Ä—É–µ–º –≤—Å–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $n$-—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ $U=\{0, \ldots, n-1\} n$-–±–∏—Ç–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏: $A \subset U$ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º $\operatorname{mask}(A)=\sum_{i \in A} 2^{i}$. –ù–æ–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–∞ –º–∞—Å—Å–∏–≤–∞; —Ç–∞–∫–∂–µ —Å –ø–æ–º–æ—â—å—é –±–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ —á–∏—Å–ª–∞–º–∏ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ

–æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏. –ü—Ä–∏–≤–µ–¥—ë–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤:
- $\operatorname{mask}(A \cup B)=\operatorname{mask}(A) \mid \operatorname{mask}(B)$, –≥–¥–µ $\mid$ - –±–∏—Ç–æ–≤–æ–µ "–ò–õ–ò";
- $\operatorname{mask}(A \cap B)=\operatorname{mask}(A) \& \operatorname{mask}(B)$, –≥–¥–µ \& - –±–∏—Ç–æ–≤–æ–µ "–ò";
- $\operatorname{mask}(A \oplus B)=\operatorname{mask}(A) \oplus \operatorname{mask}(B)$, –≥–¥–µ $\oplus$ —Å–ª–µ–≤–∞ - —Å–∏–º–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–Ω–æ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤, –∞ $\oplus$ —Å–ø—Ä–∞–≤–∞ - –±–∏—Ç–æ–≤—ã–π "XOR";
- $\operatorname{mask}(A \backslash B)=\operatorname{mask}(A) \& \sim \operatorname{mask}(B)$, –≥–¥–µ $\sim$ - –±–∏—Ç–æ–≤–æ–µ –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ;
- $\operatorname{mask}(U)=(1 \ll n)-1$, –≥–¥–µ $\ll k$ - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –Ω–∞ $k$ –±–∏—Ç –≤–ª–µ–≤–æ;
- $\operatorname{mask}(\{k\})=1 \ll k$;
- $(\operatorname{mask}(A) \gg k) \& 1$ - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, —Ä–∞–≤–Ω–æ–µ –µ–¥–∏–Ω–∏—Ü–µ —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $k \in A$ (–∑–¥–µ—Å—å $\gg k$ - –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –Ω–∞ $k$ –±–∏—Ç –≤–ø—Ä–∞–≤–æ).

–í C++ –≤—Å–µ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º "XOR", –æ–±–æ–∑–Ω–∞—á–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ —Å–∏–º–≤–æ–ª–∞–º–∏, —á—Ç–æ –∏ –≤—ã—à–µ; ^ - –±–∏—Ç–æ–≤—ã–π "XOR" –≤ C++. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —á–∏—Å–ª–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è –∑–∞ $O(1)$. –ú—ã –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —Ä–∞–∑–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–µ –≤—ã—à–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–∞ $O(1)$.

### –†–∞–∑–º–µ—Ä –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—á–∏—Å–ª–∏–º —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A \subset U$. –†–∞–∑–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–Ω—É–ª–µ–≤—ã—Ö –±–∏—Ç –≤ –µ–≥–æ –Ω–æ–º–µ—Ä–µ. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –±–∏—Ç –≤ —á–∏—Å–ª–µ $x$ —Ä–∞–≤–Ω—è–µ—Ç—Å—è —Å—É–º–º–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –±–∏—Ç –≤ $\left\lfloor\frac{x}{2}\right\rfloor$ –∏ –∑–Ω–∞—á–µ–Ω–∏—è –º–ª–∞–¥—à–µ–≥–æ –±–∏—Ç–∞ $x$.
```py
size[0] = 0 # —Ä–∞–∑–º–µ—Ä –ø—É—Å—Ç–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ä–∞–≤–µ–Ω 0
for mask = 1..((1 << n) - 1):
    size[mask] = size[mask >> 1] + (mask & 1)
```

‚úçÔ∏è –í –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–µ C++ GCC –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è $\texttt{__builtin_popcount}(x)$, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —á–∏—Å–ª–æ –±–∏—Ç –≤ —á–∏—Å–ª–µ $x$ —Ç–∏–ø–∞ $\texttt{int}$ (–µ—Å—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤); –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(1)$, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–µ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.

### –°—É–º–º–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–µ

–ü—É—Å—Ç—å –µ—Å—Ç—å $n$ —á–∏—Å–µ–ª $a_{0}, \ldots, a_{n-1}$; –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A \subset\{0, \ldots, n-1\}$ –≤—ã—á–∏—Å–ª–∏—Ç—å $s(A)=\sum_{i \in A} a_{i}$. –ú–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–∂–¥—É—é —Å—É–º–º—É –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é:
```
for mask = 0..((1 << n) - 1):
    s[mask] = 0
    for i = 0..(n - 1):
        if ((mask >> i) & 1): # i –ª–µ–∂–∏—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ —Å –Ω–æ–º–µ—Ä–æ–º mask
            s[mask] += a[i]
```

–≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç $O\left(2^{n} \cdot n\right)$ –≤—Ä–µ–º–µ–Ω–∏. –ú–æ–∂–Ω–æ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç–æ–≥–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è: –ø—É—Å—Ç—å $x \in A$ - –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —ç–ª–µ–º–µ–Ω—Ç $A$, —Ç–æ–≥–¥–∞ $s(A)=$ $s(A \backslash\{x\})+a_{x}$. –ü—Ä–∏ —ç—Ç–æ–º, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è $s$ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –º–Ω–æ–∂–µ—Å—Ç–≤, –∞ $\operatorname{mask}(A \backslash\{x\})<\operatorname{mask}(A), s(A \backslash\{x\})$ —É–∂–µ –±—É–¥–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ –∫ –º–æ–º–µ–Ω—Ç—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $s(A)$. –í –∫–∞—á–µ—Å—Ç–≤–µ $x$ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç $A$ : —Ç–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ä—à–µ–º—É –±–∏—Ç—É $\operatorname{mask}(A)$, –Ω–æ–º–µ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –≤–æ–∑—Ä–∞—Å—Ç–∞—Ç—å –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –Ω–æ–º–µ—Ä–∞. –ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\left(2^{n}\right)$ :

```py
x = 0
s[0] = 0
for mask = 1..((1<< n) - 1):
    if mask == (1 << (x + 1)): # –Ω–æ–º–µ—Ä —Å—Ç–∞—Ä—à–µ–≥–æ –±–∏—Ç–∞ —É–≤–µ–ª–∏—á–∏–ª—Å—è
        x += 1
    s[mask] = s[mask - (1 << x)] + a[x]
```

### –°—É–º–º–∞ –ø–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º

–ü—É—Å—Ç—å —Ç–µ–ø–µ—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A \subset\{0, \ldots, n-1\}$ –¥–∞–Ω–æ —á–∏—Å–ª–æ $f_{A}$, –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $A$ –≤—ã—á–∏—Å–ª–∏—Ç—å $s(A)=\sum_{B \subset A} f_{B}$.

–ú–æ–∂–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $A$ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ $B$ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –∏–∑ –Ω–∏—Ö —è–≤–ª—è—é—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ $A$; –ø–æ–ª—É—á–∏—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\left(2^{n} \cdot 2^{n}\right)=O\left(4^{n}\right)$.
```py
for A = 0..((1 << n) - 1):
    g[A] = 0
    for B = 0..((1<< n) - 1):
        if (A & B) == B: # B - –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ A
            g[A] += f[B]
```

–ú–æ–∂–Ω–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ, –∏ –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ $A$ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ $B$, —è–≤–ª—è—é—â–∏–µ—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ $A$. –ë—É–¥–µ–º –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ $A$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–º–µ–Ω—å—à–µ–Ω–∏—è –∏—Ö –Ω–æ–º–µ—Ä–æ–≤. –ü—É—Å—Ç—å $A=\left\{a_{0}, \ldots, a_{k-1}\right\}, a_{0}<\cdots < a_{k-1}$. –ï—Å–ª–∏ –º—ã –º—ã—Å–ª–µ–Ω–Ω–æ —Å–¥–≤–∏–Ω–µ–º —Ä–∞–∑—Ä—è–¥—ã $a_{0}, \ldots, a_{k-1}$ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ $0, \ldots, k-1$, —Ç–æ –Ω–æ–º–µ—Ä–∞ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ $A$ –ø–µ—Ä–µ–π–¥—É—Ç –≤ —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ $2^{k}-1$. –ó–Ω–∞—á–∏—Ç, –º—ã —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–±—Ä–∞—Ç—å —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ $2^{k}-1$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è, —Ç–æ–ª—å–∫–æ —Å–æ —Å–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Ä–∞–∑—Ä—è–¥–∞–º–∏: –Ω—É–ª–µ–≤–æ–π —Ä–∞–∑—Ä—è–¥ –Ω—É–∂–Ω–æ —Å–¥–≤–∏–Ω—É—Ç—å –≤ $a_{0}$-–π,... $(k-1)$-–π —Ä–∞–∑—Ä—è–¥ --- –≤ $a_{k-1}$-–π.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ —á–∏—Å–ª—É $i$ –ø–æ–ª—É—á–∏—Ç—å —á–∏—Å–ª–æ $i-1$, –Ω—É–∂–Ω–æ –∑–∞–Ω—É–ª–∏—Ç—å –º–ª–∞–¥—à–∏–π –µ–¥–∏–Ω–∏—á–Ω—ã–π –±–∏—Ç $i$, –∞ –≤–æ –≤—Å–µ –±–∏—Ç—ã –º–ª–∞–¥—à–µ –µ–≥–æ –∑–∞–ø–∏—Å–∞—Ç—å –µ–¥–∏–Ω–∏—Ü—É. –ó–Ω–∞—á–∏—Ç, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤—É $B \subset A$ —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ $A$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤, –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ $B$ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç $x \in B$ –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ $A \backslash B$, –º–µ–Ω—å—à–∏–µ $x$. –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º—É–ª–µ $(\operatorname{mask}(B)-1) \& \operatorname{mask}(A)$.
```py
for A = 0..((1<< n) - 1):
    g[A] = f[0] # —É—á–ª–∏ –ø—É—Å—Ç–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ
    for (B = A; B > 0; B = (( B - 1) & A)): # –≤—Å–µ –Ω–µ–ø—É—Å—Ç—ã–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ A
        g[A] += f[B]
```

–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä $(A, B)$ —Ç–∞–∫–∏—Ö, —á—Ç–æ $B \subset A$. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä —Ä–∞–≤–Ω—è–µ—Ç—Å—è $3^{n}$. –≠—Ç–æ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–º —Å–ø–æ—Å–æ–±–æ–º: –º–Ω–æ–∂–µ—Å—Ç–≤–æ $A$ —Ä–∞–∑–º–µ—Ä–∞ $k$ –∏–º–µ–µ—Ç $2^{k}$ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤ —Ä–∞–∑–º–µ—Ä–∞ $k$ —Ä–∞–≤–Ω–æ $\binom{n}{k}$, –∑–Ω–∞—á–∏—Ç, –≤—Å–µ–≥–æ –ø–∞—Ä $(A, B)$

$$
\sum_{k=0}^{n}\binom{n}{k} \cdot 2^{k}=\sum_{k=0}^{n}\binom{n}{k} \cdot 2^{k} \cdot 1^{n-k}=(2+1)^{n}=3^{n}
$$

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: –µ—Å–ª–∏ –ø–∞—Ä–∞ $(A, B)$ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞, —Ç–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Ç—Ä—ë—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π: –ª–µ–∂–∏—Ç –≤ $A$, –ª–µ–∂–∏—Ç –≤ $A \backslash B$ –∏–ª–∏ –∂–µ –Ω–µ –ª–µ–∂–∏—Ç –≤ $A$. –í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $n$, –∑–Ω–∞—á–∏—Ç, –≤—Å–µ–≥–æ $3^{n}$ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.

–ò—Ç–∞–∫, –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\left(3^{n}\right)$. –ú–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –µ—â—ë –±—ã—Å—Ç—Ä–µ–µ. –ü—É—Å—Ç—å

$$
g[A, k]=\sum_{\substack{B \subset A, A \backslash B \subset\{0, \ldots, k-1\}}} f_{B}
$$

–ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è $g[A, n]=g(A)$. –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: $g[A, 0]=f_{A}$. –ü–µ—Ä–µ—Ö–æ–¥:

$$
g[A, k+1]= \begin{cases}g[A, k], & \text { –µ—Å–ª–∏ } k \notin A, \\ g[A, k]+g[A \backslash\{k\}, k], & \text { –µ—Å–ª–∏ } k \in A .\end{cases}
$$

–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–∞–∫? $g[A, k+1]$ - —Å—É–º–º–∞ $f_{B}$ –ø–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º $B \subset A$, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç $A$ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å—é —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $0, \ldots, k$. –ï—Å–ª–∏ $k \notin A$, –≤—Å–µ —Ç–∞–∫–∏–µ $B$ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç $A$ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å—é $0, \ldots, k-1$, –∑–Ω–∞—á–∏—Ç, $g[A, k+1]=g[A, k]$. –ï—Å–ª–∏ –∂–µ $k \in A$, —Ç–æ –≤—Å–µ —Ç–∞–∫–∏–µ $B$ –¥–µ–ª—è—Ç—Å—è –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã: —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç $k$, –∏ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç. –°—É–º–º–∞ –ø–æ –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø–µ —Ä–∞–≤–Ω–∞ $g[A, k]$. –í—Å–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–æ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø–µ —è–≤–ª—è—é—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ $A \backslash\{k\}$; —Å—É–º–º–∞ –ø–æ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø–µ —Ä–∞–≤–Ω–∞ $g[A \backslash\{k\}, k]$.

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(A, k+1)$ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç —Ç–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(A, k)$, –∏, –≤–æ–∑–º–æ–∂–Ω–æ $(A \backslash\{k\}, k)$. –û–¥–Ω–∞–∫–æ –º—ã –ø–æ–ª—å–∑—É–µ–º—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º $g[A \backslash\{k\}, k]$ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ $g[A \backslash\{k\}, k]=g[A \backslash\{k\}, k+1]$. –ó–Ω–∞—á–∏—Ç, –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º –≤–º–µ—Å—Ç–æ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O\left(2^{n} \cdot n\right)$, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ $O\left(2^{n}\right)$ –ø–∞–º—è—Ç–∏.
```py
for mask = 0..((1 << n) - 1):
    g[mask] = f[mask]
for k = 0..(n - 1):
    for mask = 0..((1 << n) - 1):
        if (mask >> k) & 1:
            g[mask] += g[mask - (1 << k)]
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞
```py
fill(l, inf)
l[1, 0] = 0 # 1 - –Ω–æ–º–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ 0
# –Ω–æ–º–µ—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö 0 - –≤—Å–µ –Ω–µ—á—ë—Ç–Ω—ã–µ —á–∏—Å–ª–∞
for (mask = 1; mask < (1 << n); mask += 2):
    for v = 1..(n - 1): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—à–∏–Ω—É –ø—Ä–µ—Ñ–∏–∫—Å–∞ –º–∞—Ä—â—Ä—É—Ç–∞
        if ((mask >> v) & 1) == 0: # v –Ω–µ –ª–µ–∂–∏—Ç –≤ –ø—Ä–µ—Ñ–∏–∫—Å–µ
            continue
        for u = 0..(n - 1): # –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Ç–æ—Ä–æ–π –∫–æ–Ω–µ—Ü –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–±—Ä–∞
            if u == v or ((mask >> u) & 1) == 0:
                continue
            l[mask, v] = min(l[mask, v], l[mask - (1 << v), u] + d[u, v])
res = inf
for v = 1..(n - 1):
    res = min(res, l[(1 << n) - 1, v] + d[v, 0])
```

–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.