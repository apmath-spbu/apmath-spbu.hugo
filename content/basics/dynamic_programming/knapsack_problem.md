---
linkTitle: "üéí –ó–∞–¥–∞—á–∞ –æ —Ä—é–∫–∑–∞–∫–µ"
title: "–ó–∞–¥–∞—á–∞ –æ —Ä—é–∫–∑–∞–∫–µ"
date: 2025-04-24T17:19:09+03:00
draft: false
weight: 50
---

–ï—Å—Ç—å —Ä—é–∫–∑–∞–∫ (knapsack) –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ $W$, –∞ —Ç–∞–∫–∂–µ $n$ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤–µ—Å–∞ $w_{1}, \ldots, w_{n}$ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ $p_{1}, \ldots, p_{n}$. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Ä—é–∫–∑–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ–π —Å—É–º–º–∞—Ä–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏. –ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–∞–∫–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ $A \subset\{1, \ldots, n\}$, —á—Ç–æ $\sum_{i \in A} w_{i} \leqslant W$, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ $\sum_{i \in A} p_{i}$ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π —ç—Ç–æ–π –∑–∞–¥–∞—á–∏. –ú–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –µ—Å—Ç—å –ª–∏—à—å –æ–¥–Ω–∞ –∫–æ–ø–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ (–≤–µ—Ä—Å–∏—è "–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π"), –∞ –º–æ–∂–Ω–æ - —á—Ç–æ –∫–æ–ø–∏–π –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –º–Ω–æ–≥–æ (–≤–µ—Ä—Å–∏—è "—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏").

### –í–µ—Ä—Å–∏—è "—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏"

–ü—É—Å—Ç—å $k[j]$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–∞—è —Å—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, –µ—Å–ª–∏ —Ä—é–∫–∑–∞–∫ –∏–º–µ–µ—Ç –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å $j$. –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: $k[0]=0$. –ü–µ—Ä–µ—Ö–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã–±–æ—Ä–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∑—è—Ç–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞:

$$
k[j]=\max _{w_{i} \leqslant j}\left(k\left[j-w_{i}\right]+p_{i}\right)
$$

(–º–∞–∫—Å–∏–º—É–º –ø–æ –ø—É—Å—Ç–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É —Å—á–∏—Ç–∞–µ–º —Ä–∞–≤–Ω—ã–º –Ω—É–ª—é). –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É $-\max _{0 \leqslant j \leqslant W} k[j]$. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(n W)$ —Å $O(W)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.
```py
fill(k, 0)
for j = 0..W:
    for i = 1..n:
        if w[i] <= j:
            k[j] = max(k[j], k[j - w[i]] + p[i])
```

### –í–µ—Ä—Å–∏—è "–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π"

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ –≤–∑—è—Ç—å –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –≤–≤–µ–¥—ë–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –ü—É—Å—Ç—å $k[i, j]$ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–∞—è —Å—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–º–µ—Ç—ã —Å –Ω–æ–º–µ—Ä–∞–º–∏ –Ω–µ –±–æ–ª—å—à–µ $i$, –∞ —Ä—é–∫–∑–∞–∫ –∏–º–µ–µ—Ç –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å $j$. –ù–∞—á–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è: $k[0, j]=k[i, 0]=0$. –ü–µ—Ä–µ—Ö–æ–¥: –ª–∏–±–æ $i$-–π –ø—Ä–µ–¥–º–µ—Ç –≤—Ö–æ–¥–∏—Ç –≤ –æ—Ç–≤–µ—Ç (—Ç–æ –µ—Å—Ç—å $k[i, j]=k\left[i-1, j-w_{i}\right]$; —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ $j \geqslant w_{i}$ ), –ª–∏–±–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç (—Ç–æ –µ—Å—Ç—å $k[i, j]=k[i-1, j])$. –ü–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞ $O(n W)$ —Å —Ç–∞–∫–æ–π –∂–µ –æ—Ü–µ–Ω–∫–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. .
```py
fill(k, 0)
for i = 1..n:
    for j = 0..W:
        k[i, j] = k[i - 1, j]
        if w[i] <= j:
            k[i, j] = max(k[i, j], k[i - 1, j - w[i]] + p[i])
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ $k[i, j]$ –∞–ª–≥–æ—Ä–∏—Ç–º—É –º–æ–≥—É—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è $k[i-1, q]$ —Å $q \leqslant j$. –°–¥–µ–ª–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä—é–∫: –±—É–¥–µ–º –≤—ã—á–∏—Å–ª—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è $k[i, j]$ –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º $i$ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è $j$ (–∞ –Ω–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è, –∫–∞–∫ —Ä–∞–Ω—å—à–µ). –¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º: –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $(i, j)$ –≤ $k[0 . . j]$ –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è $k[i-1,0], \ldots, k[i-1, j]$, –∞ –≤ $k[j+1 . . W]$ - –∑–Ω–∞—á–µ–Ω–∏—è $k[i, j+1], \ldots, k[i, W]$. –ü–æ–ª—É—á–∞–µ—Ç—Å—è, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ $O(W)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏. –ü—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –∫–æ–¥ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ä–µ—à–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –∑–∞–¥–∞—á–∏ "—Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏" —Ç–æ–ª—å–∫–æ –ø–æ—Ä—è–¥–∫–æ–º –ø–µ—Ä–µ–±–æ—Ä–∞ –∑–Ω–∞—á–µ–Ω–∏–π $j$.
```
fill(k, 0)
for i = 1..n:
    for j = W..O:
        if w[i] <= j:
            k[j] = max(k[j], k[j - w[i]] + p[i])
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞

–í –≤–µ—Ä—Å–∏–∏ —Å –¥–≤—É–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏. –í –≤–µ—Ä—Å–∏–∏ —Å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º –æ—Ç–≤–µ—Ç –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ —É–¥–∞—Å—Ç—Å—è; –∑–∞—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–¥–µ—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –•–∏—Ä—à–±–µ—Ä–≥–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–≤–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è $O(W+\log n)$ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –∏ –Ω–µ —É—Ö—É–¥—à–∏–≤ –æ—Ü–µ–Ω–∫—É –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã.